<post-item>
  <div class="content">
    <h3>
      <a href="{{ include.post.url | relative_url }}">
        {{ include.post.title | escape }}
      </a>
    </h3>
    
    {%- if include.post.summary -%}
      {{ include.post.summary | markdownify }}
    {%- else -%}
      {%- assign paragraphs = include.post.content | split: "</p>" -%}
      {%- for p in paragraphs -%}
        {%- if p contains "<p>" -%}
          {%- assign text = p | split: "<p>" | last -%}
          {%- unless text contains "<h1" or text contains "<h2" or text contains "<h3" or text contains "<h4" or text contains "<h5" or text contains "<h6" -%}
            {%- assign stripped = text | strip_html | strip -%}
            {%- unless stripped == "" -%}
              <p>{{ text }}</p>
              {%- break -%}
            {%- endunless -%}
          {%- endunless -%}
        {%- endif -%}
      {%- endfor -%}
    {%- endif -%}

    {%- if include.post.categories.size > 0 -%}
      <div class="categories">
        {%- for category in include.post.categories -%}
          <category-badge data-category="{{ category | slugify }}">{{ category }}</category-badge>
        {%- endfor -%}
      </div>
    {%- endif -%}
    
    <time datetime="{{ include.post.date | date_to_xmlschema }}">
      {%- assign date_format = site.minima.date_format | default: "%b %-d, %Y" -%}
      {{ include.post.date | date: date_format }}
    </time>
  </div>
  
  {%- if include.post.thumbnail -%}
    <img src="{{ include.post.thumbnail | relative_url }}" alt="{{ include.post.title | escape }}">
  {%- endif -%}
</post-item>